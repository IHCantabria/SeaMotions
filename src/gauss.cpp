
// Include general usage libraries
#include <iostream>

// Include local modules
#include "gauss.hpp"


void get_gauss_legendre(int num_points, cusfloat* weights, cusfloat* roots)
{
    switch (num_points)
    {
        case 1:
            roots[0] = 0.0000000000000000;

            weights[0] = 2.0000000000000000;
        case 2:
            roots[0] = -0.5773502691896257;
            roots[1] = 0.5773502691896257;

            weights[0] = 1.0000000000000000;
            weights[1] = 1.0000000000000000;
        case 3:
            roots[0] = -0.7745966692414834;
            roots[1] = 0.0000000000000000;
            roots[2] = 0.7745966692414834;

            weights[0] = 0.5555555555555554;
            weights[1] = 0.8888888888888888;
            weights[2] = 0.5555555555555554;
        case 4:
            roots[0] = -0.8611363115940526;
            roots[1] = -0.3399810435848563;
            roots[2] = 0.3399810435848563;
            roots[3] = 0.8611363115940526;

            weights[0] = 0.3478548451374538;
            weights[1] = 0.6521451548625461;
            weights[2] = 0.6521451548625461;
            weights[3] = 0.3478548451374538;
        case 5:
            roots[0] = -0.9061798459386640;
            roots[1] = -0.5384693101056831;
            roots[2] = 0.0000000000000000;
            roots[3] = 0.5384693101056831;
            roots[4] = 0.9061798459386640;

            weights[0] = 0.2369268850561891;
            weights[1] = 0.4786286704993665;
            weights[2] = 0.5688888888888889;
            weights[3] = 0.4786286704993665;
            weights[4] = 0.2369268850561891;
        case 6:
            roots[0] = -0.9324695142031521;
            roots[1] = -0.6612093864662645;
            roots[2] = -0.2386191860831969;
            roots[3] = 0.2386191860831969;
            roots[4] = 0.6612093864662645;
            roots[5] = 0.9324695142031521;

            weights[0] = 0.1713244923791702;
            weights[1] = 0.3607615730481387;
            weights[2] = 0.4679139345726913;
            weights[3] = 0.4679139345726913;
            weights[4] = 0.3607615730481387;
            weights[5] = 0.1713244923791702;
        case 7:
            roots[0] = -0.9491079123427585;
            roots[1] = -0.7415311855993945;
            roots[2] = -0.4058451513773971;
            roots[3] = 0.0000000000000000;
            roots[4] = 0.4058451513773971;
            roots[5] = 0.7415311855993945;
            roots[6] = 0.9491079123427585;

            weights[0] = 0.1294849661688698;
            weights[1] = 0.2797053914892765;
            weights[2] = 0.3818300505051192;
            weights[3] = 0.4179591836734694;
            weights[4] = 0.3818300505051192;
            weights[5] = 0.2797053914892765;
            weights[6] = 0.1294849661688698;
        case 8:
            roots[0] = -0.9602898564975363;
            roots[1] = -0.7966664774136267;
            roots[2] = -0.5255324099163290;
            roots[3] = -0.1834346424956498;
            roots[4] = 0.1834346424956498;
            roots[5] = 0.5255324099163290;
            roots[6] = 0.7966664774136267;
            roots[7] = 0.9602898564975363;

            weights[0] = 0.1012285362903759;
            weights[1] = 0.2223810344533745;
            weights[2] = 0.3137066458778874;
            weights[3] = 0.3626837833783619;
            weights[4] = 0.3626837833783619;
            weights[5] = 0.3137066458778874;
            weights[6] = 0.2223810344533745;
            weights[7] = 0.1012285362903759;
        case 9:
            roots[0] = -0.9681602395076261;
            roots[1] = -0.8360311073266358;
            roots[2] = -0.6133714327005904;
            roots[3] = -0.3242534234038089;
            roots[4] = 0.0000000000000000;
            roots[5] = 0.3242534234038089;
            roots[6] = 0.6133714327005904;
            roots[7] = 0.8360311073266358;
            roots[9] = 0.9681602395076261;

            weights[0] = 0.0812743883615745;
            weights[1] = 0.1806481606948575;
            weights[2] = 0.2606106964029354;
            weights[3] = 0.3123470770400029;
            weights[4] = 0.3302393550012598;
            weights[5] = 0.3123470770400029;
            weights[6] = 0.2606106964029354;
            weights[7] = 0.1806481606948575;
            weights[8] = 0.0812743883615745;
        case 10:
            roots[0] = -0.9739065285171717;
            roots[1] = -0.8650633666889845;
            roots[2] = -0.6794095682990244;
            roots[3] = -0.4333953941292472;
            roots[4] = -0.1488743389816312;
            roots[5] = 0.1488743389816312;
            roots[6] = 0.4333953941292472;
            roots[7] = 0.6794095682990244;
            roots[8] = 0.8650633666889845;
            roots[9] = 0.9739065285171717;

            weights[0] = 0.0666713443086882;
            weights[1] = 0.1494513491505807;
            weights[2] = 0.2190863625159821;
            weights[3] = 0.2692667193099962;
            weights[4] = 0.2955242247147529;
            weights[5] = 0.2955242247147529;
            weights[6] = 0.2692667193099963;
            weights[7] = 0.2190863625159821;
            weights[8] = 0.1494513491505807;
            weights[9] = 0.0666713443086882;
        default:
            std::string err_message("Number of gauss points specified not available.");
            std::cerr << err_message << std::endl;
            throw std::runtime_error(err_message);
    }
}