
/*
 * Copyright (c) 2025 Sergio Fern√°ndez Ruano / IHCantabria
 *
 * This file is part of SeaMotions Software.
 *
 * SeaMotions is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * SeaMotions is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <https://www.gnu.org/licenses/>.
 */

// Include general usage libraries
#include <iostream>
#include <string>

// Include local modules
#include "gauss.hpp"


void get_gauss_legendre(int num_points, cusfloat* roots, cusfloat* weights)
{
    switch (num_points)
    {
        case 1:
            roots[0] = 0.0;

            weights[0] = 2.0;
            break;

        case 2:
            roots[0] = -0.5773502691896257;
            roots[1] = 0.5773502691896257;

            weights[0] = 1.0;
            weights[1] = 1.0;
            break;

        case 3:
            roots[0] = -0.7745966692414834;
            roots[1] = +0.0000000000000000;
            roots[2] = +0.7745966692414834;

            weights[0] = 0.5555555555555557;
            weights[1] = 0.8888888888888883;
            weights[2] = 0.5555555555555557;
            break;

        case 4:
            roots[0] = -0.8611363115940526;
            roots[1] = -0.3399810435848563;
            roots[2] = +0.3399810435848563;
            roots[3] = +0.8611363115940526;

            weights[0] = 0.3478548451374538;
            weights[1] = 0.6521451548625462;
            weights[2] = 0.6521451548625462;
            weights[3] = 0.3478548451374538;
            break;

        case 5:
            roots[0] = -0.9061798459386640;
            roots[1] = -0.5384693101056831;
            roots[2] = +0.0000000000000000;
            roots[3] = +0.5384693101056831;
            roots[4] = +0.9061798459386640;

            weights[0] = 0.23692688505618897;
            weights[1] = 0.47862867049936650;
            weights[2] = 0.56888888888888910;
            weights[3] = 0.47862867049936650;
            weights[4] = 0.23692688505618897;
            break;

        case 6:
            roots[0] = -0.93246951420315200;
            roots[1] = -0.66120938646626450;
            roots[2] = -0.23861918608319693;
            roots[3] = +0.23861918608319693;
            roots[4] = +0.66120938646626450;
            roots[5] = +0.93246951420315200;

            weights[0] = 0.17132449237917022;
            weights[1] = 0.36076157304813855;
            weights[2] = 0.46791393457269130;
            weights[3] = 0.46791393457269130;
            weights[4] = 0.36076157304813855;
            weights[5] = 0.17132449237917022;
            break;

        case 7:
            roots[0] = -0.9491079123427584;
            roots[1] = -0.7415311855993945;
            roots[2] = -0.4058451513773972;
            roots[3] = +0.0000000000000000;
            roots[4] = +0.4058451513773972;
            roots[5] = +0.7415311855993945;
            roots[6] = +0.9491079123427584;

            weights[0] = 0.12948496616886998;
            weights[1] = 0.27970539148927664;
            weights[2] = 0.38183005050511876;
            weights[3] = 0.41795918367346910;
            weights[4] = 0.38183005050511876;
            weights[5] = 0.27970539148927664;
            weights[6] = 0.12948496616886998;
            break;

        case 8:
            roots[0] = -0.96028985649753630;
            roots[1] = -0.79666647741362670;
            roots[2] = -0.52553240991632900;
            roots[3] = -0.18343464249564984;
            roots[4] = +0.18343464249564984;
            roots[5] = +0.52553240991632900;
            roots[6] = +0.79666647741362670;
            roots[7] = +0.96028985649753630;

            weights[0] = 0.10122853629037560;
            weights[1] = 0.22238103445337470;
            weights[2] = 0.31370664587788766;
            weights[3] = 0.36268378337836210;
            weights[4] = 0.36268378337836210;
            weights[5] = 0.31370664587788766;
            weights[6] = 0.22238103445337470;
            weights[7] = 0.10122853629037560;
            break;

        case 9:
            roots[0] = -0.9681602395076261;
            roots[1] = -0.8360311073266358;
            roots[2] = -0.6133714327005904;
            roots[3] = -0.3242534234038089;
            roots[4] = +0.0000000000000000;
            roots[5] = +0.3242534234038089;
            roots[6] = +0.6133714327005904;
            roots[7] = +0.8360311073266358;
            roots[8] = +0.9681602395076261;

            weights[0] = 0.08127438836157415;
            weights[1] = 0.18064816069485760;
            weights[2] = 0.26061069640293550;
            weights[3] = 0.31234707704000286;
            weights[4] = 0.33023935500125967;
            weights[5] = 0.31234707704000286;
            weights[6] = 0.26061069640293550;
            weights[7] = 0.18064816069485760;
            weights[8] = 0.08127438836157415;
            break;

        case 10:
            roots[0] = -0.97390652851717170;
            roots[1] = -0.86506336668898440;
            roots[2] = -0.67940956829902440;
            roots[3] = -0.43339539412924720;
            roots[4] = -0.14887433898163116;
            roots[5] = +0.14887433898163116;
            roots[6] = +0.43339539412924720;
            roots[7] = +0.67940956829902440;
            roots[8] = +0.86506336668898440;
            roots[9] = +0.97390652851717170;

            weights[0] = 0.06667134430868715;
            weights[1] = 0.14945134915058056;
            weights[2] = 0.21908636251598224;
            weights[3] = 0.26926671930999674;
            weights[4] = 0.29552422471475330;
            weights[5] = 0.29552422471475330;
            weights[6] = 0.26926671930999674;
            weights[7] = 0.21908636251598224;
            weights[8] = 0.14945134915058056;
            weights[9] = 0.06667134430868715;
            break;

        case 11:
            roots[0] =  -0.97822865814605700;
            roots[1] =  -0.88706259976809530;
            roots[2] =  -0.73015200557404940;
            roots[3] =  -0.51909612920681190;
            roots[4] =  -0.26954315595234496;
            roots[5] =  +0.00000000000000000;
            roots[6] =  +0.26954315595234496;
            roots[7] =  +0.51909612920681190;
            roots[8] =  +0.73015200557404940;
            roots[9] =  +0.88706259976809530;
            roots[10] = +0.97822865814605700;

            weights[0] =  0.055668567116174315;
            weights[1] =  0.125580369464903860;
            weights[2] =  0.186290210927734480;
            weights[3] =  0.233193764591990500;
            weights[4] =  0.262804544510246650;
            weights[5] =  0.272925086777900600;
            weights[6] =  0.262804544510246650;
            weights[7] =  0.233193764591990500;
            weights[8] =  0.186290210927734480;
            weights[9] =  0.125580369464903860;
            weights[10] = 0.055668567116174315;
            break;

        case 12:
            roots[0] =  -0.98156063424671920;
            roots[1] =  -0.90411725637047490;
            roots[2] =  -0.76990267419430470;
            roots[3] =  -0.58731795428661750;
            roots[4] =  -0.36783149899818013;
            roots[5] =  -0.12523340851146897;
            roots[6] =  +0.12523340851146897;
            roots[7] =  +0.36783149899818013;
            roots[8] =  +0.58731795428661750;
            roots[9] =  +0.76990267419430470;
            roots[10] = +0.90411725637047490;
            roots[11] = +0.98156063424671920;

            weights[0] =  0.04717533638651318;
            weights[1] =  0.10693932599531779;
            weights[2] =  0.16007832854334605;
            weights[3] =  0.20316742672306570;
            weights[4] =  0.23349253653835467;
            weights[5] =  0.24914704581340258;
            weights[6] =  0.24914704581340258;
            weights[7] =  0.23349253653835467;
            weights[8] =  0.20316742672306570;
            weights[9] =  0.16007832854334605;
            weights[10] = 0.10693932599531779;
            weights[11] = 0.04717533638651318;
            break;

        case 13:
            roots[0] =  -0.98418305471858810;
            roots[1] =  -0.91759839922297790;
            roots[2] =  -0.80157809073330990;
            roots[3] =  -0.64234933944034030;
            roots[4] =  -0.44849275103644687;
            roots[5] =  -0.23045831595513483;
            roots[6] =  +0.00000000000000000;
            roots[7] =  +0.23045831595513483;
            roots[8] =  +0.44849275103644687;
            roots[9] =  +0.64234933944034030;
            roots[10] = +0.80157809073330990;
            roots[11] = +0.91759839922297790;
            roots[12] = +0.98418305471858810;

            weights[0] =  0.04048400476531615;
            weights[1] =  0.09212149983772760;
            weights[2] =  0.13887351021978760;
            weights[3] =  0.17814598076194554;
            weights[4] =  0.20781604753688862;
            weights[5] =  0.22628318026289750;
            weights[6] =  0.23255155323087406;
            weights[7] =  0.22628318026289750;
            weights[8] =  0.20781604753688862;
            weights[9] =  0.17814598076194554;
            weights[10] = 0.13887351021978760;
            weights[11] = 0.09212149983772760;
            weights[12] = 0.04048400476531615;
            break;

        case 14:
            roots[0] =  -0.98628380869681220;
            roots[1] =  -0.92843488366357350;
            roots[2] =  -0.82720131506976500;
            roots[3] =  -0.68729290481168550;
            roots[4] =  -0.51524863635815410;
            roots[5] =  -0.31911236892788974;
            roots[6] =  -0.10805494870734363;
            roots[7] =  +0.10805494870734363;
            roots[8] =  +0.31911236892788974;
            roots[9] =  +0.51524863635815410;
            roots[10] = +0.68729290481168550;
            roots[11] = +0.82720131506976500;
            roots[12] = +0.92843488366357350;
            roots[13] = +0.98628380869681220;

            weights[0] =  0.035119460331752915;
            weights[1] =  0.080158087159759540;
            weights[2] =  0.121518570687902950;
            weights[3] =  0.157203167158193630;
            weights[4] =  0.185538397477937820;
            weights[5] =  0.205198463721295520;
            weights[6] =  0.215263853463157660;
            weights[7] =  0.215263853463157660;
            weights[8] =  0.205198463721295520;
            weights[9] =  0.185538397477937820;
            weights[10] = 0.157203167158193630;
            weights[11] = 0.121518570687902950;
            weights[12] = 0.080158087159759540;
            weights[13] = 0.035119460331752915;
            break;

        case 15:
            roots[0] =  -0.98799251802048540;
            roots[1] =  -0.93727339240070600;
            roots[2] =  -0.84820658341042720;
            roots[3] =  -0.72441773136017010;
            roots[4] =  -0.57097217260853880;
            roots[5] =  -0.39415134707756340;
            roots[6] =  -0.20119409399743454;
            roots[7] =  +0.00000000000000000;
            roots[8] =  +0.20119409399743454;
            roots[9] =  +0.39415134707756340;
            roots[10] = +0.57097217260853880;
            roots[11] = +0.72441773136017010;
            roots[12] = +0.84820658341042720;
            roots[13] = +0.93727339240070600;
            roots[14] = +0.98799251802048540;

            weights[0] =  0.03075324199611815;
            weights[1] =  0.07036604748810715;
            weights[2] =  0.10715922046717173;
            weights[3] =  0.13957067792615430;
            weights[4] =  0.16626920581699410;
            weights[5] =  0.18616100001556220;
            weights[6] =  0.19843148532711160;
            weights[7] =  0.20257824192556134;
            weights[8] =  0.19843148532711160;
            weights[9] =  0.18616100001556220;
            weights[10] = 0.16626920581699410;
            weights[11] = 0.13957067792615430;
            weights[12] = 0.10715922046717173;
            weights[13] = 0.07036604748810715;
            weights[14] = 0.03075324199611815;
            break;

        case 16:
            roots[0] =  -0.98940093499164990;
            roots[1] =  -0.94457502307323260;
            roots[2] =  -0.86563120238783180;
            roots[3] =  -0.75540440835500300;
            roots[4] =  -0.61787624440264380;
            roots[5] =  -0.45801677765722740;
            roots[6] =  -0.28160355077925890;
            roots[7] =  -0.09501250983763745;
            roots[8] =  +0.09501250983763745;
            roots[9] =  +0.28160355077925890;
            roots[10] = +0.45801677765722740;
            roots[11] = +0.61787624440264380;
            roots[12] = +0.75540440835500300;
            roots[13] = +0.86563120238783180;
            roots[14] = +0.94457502307323260;
            roots[15] = +0.98940093499164990;

            weights[0] =  0.027152459411756466;
            weights[1] =  0.062253523938647620;
            weights[2] =  0.095158511682492310;
            weights[3] =  0.124628971255533630;
            weights[4] =  0.149595988816576380;
            weights[5] =  0.169156519395002120;
            weights[6] =  0.182603415044923300;
            weights[7] =  0.189450610455068090;
            weights[8] =  0.189450610455068090;
            weights[9] =  0.182603415044923300;
            weights[10] = 0.169156519395002120;
            weights[11] = 0.149595988816576380;
            weights[12] = 0.124628971255533630;
            weights[13] = 0.095158511682492310;
            weights[14] = 0.062253523938647620;
            weights[15] = 0.027152459411756466;
            break;

        case 17:
            roots[0] =  -0.99057547531441740;
            roots[1] =  -0.95067552176876780;
            roots[2] =  -0.88023915372698600;
            roots[3] =  -0.78151400389680140;
            roots[4] =  -0.65767115921669080;
            roots[5] =  -0.51269053708647690;
            roots[6] =  -0.35123176345387636;
            roots[7] =  -0.17848418149584777;
            roots[8] =  +0.00000000000000000;
            roots[9] =  +0.17848418149584777;
            roots[10] = +0.35123176345387636;
            roots[11] = +0.51269053708647690;
            roots[12] = +0.65767115921669080;
            roots[13] = +0.78151400389680140;
            roots[14] = +0.88023915372698600;
            roots[15] = +0.95067552176876780;
            roots[16] = +0.99057547531441740;

            weights[0] =  0.02414830286854719;
            weights[1] =  0.05545952937398706;
            weights[2] =  0.08503614831717916;
            weights[3] =  0.11188384719340384;
            weights[4] =  0.13513636846852553;
            weights[5] =  0.15404576107681064;
            weights[6] =  0.16800410215645020;
            weights[7] =  0.17656270536699292;
            weights[8] =  0.17944647035620678;
            weights[9] =  0.17656270536699292;
            weights[10] = 0.16800410215645020;
            weights[11] = 0.15404576107681064;
            weights[12] = 0.13513636846852553;
            weights[13] = 0.11188384719340384;
            weights[14] = 0.08503614831717916;
            weights[15] = 0.05545952937398706;
            weights[16] = 0.02414830286854719;
            break;

        case 18:
            roots[0] =  -0.99156516842093090;
            roots[1] =  -0.95582394957139760;
            roots[2] =  -0.89260246649755580;
            roots[3] =  -0.80370495897252310;
            roots[4] =  -0.69168704306035320;
            roots[5] =  -0.55977083107394750;
            roots[6] =  -0.41175116146284270;
            roots[7] =  -0.25188622569150560;
            roots[8] =  -0.08477501304173532;
            roots[9] =  +0.08477501304173532;
            roots[10] = +0.25188622569150560;
            roots[11] = +0.41175116146284270;
            roots[12] = +0.55977083107394750;
            roots[13] = +0.69168704306035320;
            roots[14] = +0.80370495897252310;
            roots[15] = +0.89260246649755580;
            roots[16] = +0.95582394957139760;
            roots[17] = +0.99156516842093090;

            weights[0] =  0.02161601352648239;
            weights[1] =  0.04971454889497083;
            weights[2] =  0.07642573025488873;
            weights[3] =  0.10094204410628753;
            weights[4] =  0.12255520671147814;
            weights[5] =  0.14064291467065074;
            weights[6] =  0.15468467512626527;
            weights[7] =  0.16427648374583267;
            weights[8] =  0.16914238296314368;
            weights[9] =  0.16914238296314368;
            weights[10] = 0.16427648374583267;
            weights[11] = 0.15468467512626527;
            weights[12] = 0.14064291467065074;
            weights[13] = 0.12255520671147814;
            weights[14] = 0.10094204410628753;
            weights[15] = 0.07642573025488873;
            weights[16] = 0.04971454889497083;
            weights[17] = 0.02161601352648239;
            break;

        case 19:
            roots[0] =  -0.99240684384358440;
            roots[1] =  -0.96020815213483000;
            roots[2] =  -0.90315590361481780;
            roots[3] =  -0.82271465653714280;
            roots[4] =  -0.72096617733522940;
            roots[5] =  -0.60054530466168100;
            roots[6] =  -0.46457074137596090;
            roots[7] =  -0.31656409996362990;
            roots[8] =  -0.16035864564022534;
            roots[9] =  +0.00000000000000000;
            roots[10] = +0.16035864564022534;
            roots[11] = +0.31656409996362990;
            roots[12] = +0.46457074137596090;
            roots[13] = +0.60054530466168100;
            roots[14] = +0.72096617733522940;
            roots[15] = +0.82271465653714280;
            roots[16] = +0.90315590361481780;
            roots[17] = +0.96020815213483000;
            roots[18] = +0.99240684384358440;

            weights[0] =  0.019461788229728976;
            weights[1] =  0.044814226765699290;
            weights[2] =  0.069044542737641180;
            weights[3] =  0.091490021622449710;
            weights[4] =  0.111566645547333750;
            weights[5] =  0.128753962539335850;
            weights[6] =  0.142606702173606380;
            weights[7] =  0.152766042065859230;
            weights[8] =  0.158968843393954030;
            weights[9] =  0.161054449848783250;
            weights[10] = 0.158968843393954030;
            weights[11] = 0.152766042065859230;
            weights[12] = 0.142606702173606380;
            weights[13] = 0.128753962539335850;
            weights[14] = 0.111566645547333750;
            weights[15] = 0.091490021622449710;
            weights[16] = 0.069044542737641180;
            weights[17] = 0.044814226765699290;
            weights[18] = 0.019461788229728976;
            break;

        default:
            std::string err_message("Number of gauss points specified not available.");
            std::cerr << err_message << std::endl;
            throw std::runtime_error(err_message);
    }
}
