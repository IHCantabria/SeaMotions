
// Include general usage scientific libraries
#include <cmath>

// Include local modules
#include "../config.hpp"
#include "math_tools.hpp"


cusfloat chebyshev_poly_raw(int n, cusfloat x)
{
    // Include name
    using namespace std;

    // Look for the Lengendre polynomial
    cusfloat tn = 0.0;
    cusfloat x2 = pow2s(x);
    cusfloat xi = 0.0;
    switch (n)
    {
        case 0:
        return 1.0;

        case 1:
        return x;

        case 2:
        tn = -1.0;
        xi = x2;
        tn += 2.0*xi;
        return tn;

        case 3:
        xi = x;
        tn = -3.0*xi;
        xi *= x2;
        tn += 4.0*xi;
        return tn;

        case 4:
        tn = 1.0;
        xi = x2;
        tn -= 8.0*xi;
        xi *= x2;
        tn += 8.0*xi;
        return tn;

        case 5:
        xi = x;
        tn = 5.0*xi;
        xi *= x2;
        tn -= 20.0*xi;
        xi *= x2;
        tn += 16.0*xi;
        return tn;

        case 6:
        tn = -1.0;
        xi = x2;
        tn += 18.0*xi;
        xi *= x2;
        tn -= 48.0*xi;
        xi *= x2;
        tn += 32.0*xi;
        return tn;

        case 7:
        xi = x;
        tn = -7.0*xi;
        xi *= x2;
        tn += 56.0*xi;
        xi *= x2;
        tn -= 112.0*xi;
        xi *= x2;
        tn += 64.0*xi;
        return tn;

        case 8:
        tn = 1.0;
        xi = x2;
        tn -= 32.0*xi;
        xi *= x2;
        tn += 160.0*xi;
        xi *= x2;
        tn -= 256.0*xi;
        xi *= x2;
        tn += 128.0*xi;
        return tn;

        case 9:
        xi = x;
        tn = 9.0*xi;
        xi *= x2;
        tn -= 120.0*xi;
        xi *= x2;
        tn += 432.0*xi;
        xi *= x2;
        tn -= 576.0*xi;
        xi *= x2;
        tn += 256.0*xi;
        return tn;

        case 10:
        tn = -1.0;
        xi = x2;
        tn += 50.0*xi;
        xi *= x2;
        tn -= 400.0*xi;
        xi *= x2;
        tn += 1120.0*xi;
        xi *= x2;
        tn -= 1280.0*xi;
        xi *= x2;
        tn += 512.0*xi;
        return tn;

        case 11:
        xi = x;
        tn = -11.0*xi;
        xi *= x2;
        tn += 220.0*xi;
        xi *= x2;
        tn -= 1232.0*xi;
        xi *= x2;
        tn += 2816.0*xi;
        xi *= x2;
        tn -= 2816.0*xi;
        xi *= x2;
        tn += 1024.0*xi;
        return tn;

        case 12:
        tn = 1.0;
        xi = x2;
        tn -= 72.0*xi;
        xi *= x2;
        tn += 840.0*xi;
        xi *= x2;
        tn -= 3584.0*xi;
        xi *= x2;
        tn += 6912.0*xi;
        xi *= x2;
        tn -= 6144.0*xi;
        xi *= x2;
        tn += 2048.0*xi;
        return tn;

        case 13:
        xi = x;
        tn = 13.0*xi;
        xi *= x2;
        tn -= 364.0*xi;
        xi *= x2;
        tn += 2912.0*xi;
        xi *= x2;
        tn -= 9984.0*xi;
        xi *= x2;
        tn += 16640.0*xi;
        xi *= x2;
        tn -= 13312.0*xi;
        xi *= x2;
        tn += 4096.0*xi;
        return tn;

        case 14:
        tn = -1.0;
        xi = x2;
        tn += 98.0*xi;
        xi *= x2;
        tn -= 1568.0*xi;
        xi *= x2;
        tn += 9408.0*xi;
        xi *= x2;
        tn -= 26880.0*xi;
        xi *= x2;
        tn += 39424.0*xi;
        xi *= x2;
        tn -= 28672.0*xi;
        xi *= x2;
        tn += 8192.0*xi;
        return tn;

        case 15:
        xi = x;
        tn = -15.0*xi;
        xi *= x2;
        tn += 560.0*xi;
        xi *= x2;
        tn -= 6048.0*xi;
        xi *= x2;
        tn += 28800.0*xi;
        xi *= x2;
        tn -= 70400.0*xi;
        xi *= x2;
        tn += 92160.0*xi;
        xi *= x2;
        tn -= 61440.0*xi;
        xi *= x2;
        tn += 16384.0*xi;
        return tn;

        case 16:
        tn = 1.0;
        xi = x2;
        tn -= 128.0*xi;
        xi *= x2;
        tn += 2688.0*xi;
        xi *= x2;
        tn -= 21504.0*xi;
        xi *= x2;
        tn += 84480.0*xi;
        xi *= x2;
        tn -= 180224.0*xi;
        xi *= x2;
        tn += 212992.0*xi;
        xi *= x2;
        tn -= 131072.0*xi;
        xi *= x2;
        tn += 32768.0*xi;
        return tn;

        case 17:
        xi = x;
        tn = 17.0*xi;
        xi *= x2;
        tn -= 816.0*xi;
        xi *= x2;
        tn += 11424.0*xi;
        xi *= x2;
        tn -= 71808.0*xi;
        xi *= x2;
        tn += 239360.0*xi;
        xi *= x2;
        tn -= 452608.0*xi;
        xi *= x2;
        tn += 487424.0*xi;
        xi *= x2;
        tn -= 278528.0*xi;
        xi *= x2;
        tn += 65536.0*xi;
        return tn;

        case 18:
        tn = -1.0;
        xi = x2;
        tn += 162.0*xi;
        xi *= x2;
        tn -= 4320.0*xi;
        xi *= x2;
        tn += 44352.0*xi;
        xi *= x2;
        tn -= 228096.0*xi;
        xi *= x2;
        tn += 658944.0*xi;
        xi *= x2;
        tn -= 1118208.0*xi;
        xi *= x2;
        tn += 1105920.0*xi;
        xi *= x2;
        tn -= 589824.0*xi;
        xi *= x2;
        tn += 131072.0*xi;
        return tn;

        case 19:
        xi = x;
        tn = -19.0*xi;
        xi *= x2;
        tn += 1140.0*xi;
        xi *= x2;
        tn -= 20064.0*xi;
        xi *= x2;
        tn += 160512.0*xi;
        xi *= x2;
        tn -= 695552.0*xi;
        xi *= x2;
        tn += 1770496.0*xi;
        xi *= x2;
        tn -= 2723840.0*xi;
        xi *= x2;
        tn += 2490368.0*xi;
        xi *= x2;
        tn -= 1245184.0*xi;
        xi *= x2;
        tn += 262144.0*xi;
        return tn;

        case 20:
        tn = 1.0;
        xi = x2;
        tn -= 200.0*xi;
        xi *= x2;
        tn += 6600.0*xi;
        xi *= x2;
        tn -= 84480.0*xi;
        xi *= x2;
        tn += 549120.0*xi;
        xi *= x2;
        tn -= 2050048.0*xi;
        xi *= x2;
        tn += 4659200.0*xi;
        xi *= x2;
        tn -= 6553600.0*xi;
        xi *= x2;
        tn += 5570560.0*xi;
        xi *= x2;
        tn -= 2621440.0*xi;
        xi *= x2;
        tn += 524288.0*xi;
        return tn;

        default:
        std::string err_message("Raw Chebyshev polynomial defined for a degree en between 0 and 10.");
        std::cerr << err_message << std::endl;
        throw std::runtime_error(err_message);
    }
}


cusfloat chebyshev_poly_der_raw(int n, cusfloat x)
{
    // Include name
    using namespace std;

    // Look for the Lengendre polynomial
    cusfloat tn = 0.0;
    cusfloat x2 = pow2s(x);
    cusfloat xi = 0.0;
    switch (n)
    {
        case 0:
        return 0.0;

        case 1:
        return 1.0;

        case 2:
        return 4*x;

        case 3:
        return 12*pow(x, 2)-3;

        case 4:
        xi = x;
        tn = -16.0*xi;
        xi *= x2;
        tn += 32.0*xi;
        return tn;

        case 5:
        tn = 5.0;
        xi = x2;
        tn -= 60.0*xi;
        xi *= x2;
        tn += 80.0*xi;
        return tn;

        case 6:
        xi = x;
        tn = 36.0*xi;
        xi *= x2;
        tn -= 192.0*xi;
        xi *= x2;
        tn += 192.0*xi;
        return tn;

        case 7:
        tn = -7.0;
        xi = x2;
        tn += 168.0*xi;
        xi *= x2;
        tn -= 560.0*xi;
        xi *= x2;
        tn += 448.0*xi;
        return tn;

        case 8:
        xi = x;
        tn = -64.0*xi;
        xi *= x2;
        tn += 640.0*xi;
        xi *= x2;
        tn -= 1536.0*xi;
        xi *= x2;
        tn += 1024.0*xi;
        return tn;

        case 9:
        tn = 9.0;
        xi = x2;
        tn -= 360.0*xi;
        xi *= x2;
        tn += 2160.0*xi;
        xi *= x2;
        tn -= 4032.0*xi;
        xi *= x2;
        tn += 2304.0*xi;
        return tn;

        case 10:
        xi = x;
        tn = 100.0*xi;
        xi *= x2;
        tn -= 1600.0*xi;
        xi *= x2;
        tn += 6720.0*xi;
        xi *= x2;
        tn -= 10240.0*xi;
        xi *= x2;
        tn += 5120.0*xi;
        return tn;

        case 11:
        tn = -11.0;
        xi = x2;
        tn += 660.0*xi;
        xi *= x2;
        tn -= 6160.0*xi;
        xi *= x2;
        tn += 19712.0*xi;
        xi *= x2;
        tn -= 25344.0*xi;
        xi *= x2;
        tn += 11264.0*xi;
        return tn;

        case 12:
        xi = x;
        tn = -144.0*xi;
        xi *= x2;
        tn += 3360.0*xi;
        xi *= x2;
        tn -= 21504.0*xi;
        xi *= x2;
        tn += 55296.0*xi;
        xi *= x2;
        tn -= 61440.0*xi;
        xi *= x2;
        tn += 24576.0*xi;
        return tn;

        case 13:
        tn = 13.0;
        xi = x2;
        tn -= 1092.0*xi;
        xi *= x2;
        tn += 14560.0*xi;
        xi *= x2;
        tn -= 69888.0*xi;
        xi *= x2;
        tn += 149760.0*xi;
        xi *= x2;
        tn -= 146432.0*xi;
        xi *= x2;
        tn += 53248.0*xi;
        return tn;

        case 14:
        xi = x;
        tn = 196.0*xi;
        xi *= x2;
        tn -= 6272.0*xi;
        xi *= x2;
        tn += 56448.0*xi;
        xi *= x2;
        tn -= 215040.0*xi;
        xi *= x2;
        tn += 394240.0*xi;
        xi *= x2;
        tn -= 344064.0*xi;
        xi *= x2;
        tn += 114688.0*xi;
        return tn;

        case 15:
        tn = -15.0;
        xi = x2;
        tn += 1680.0*xi;
        xi *= x2;
        tn -= 30240.0*xi;
        xi *= x2;
        tn += 201600.0*xi;
        xi *= x2;
        tn -= 633600.0*xi;
        xi *= x2;
        tn += 1013760.0*xi;
        xi *= x2;
        tn -= 798720.0*xi;
        xi *= x2;
        tn += 245760.0*xi;
        return tn;

        case 16:
        xi = x;
        tn = -256.0*xi;
        xi *= x2;
        tn += 10752.0*xi;
        xi *= x2;
        tn -= 129024.0*xi;
        xi *= x2;
        tn += 675840.0*xi;
        xi *= x2;
        tn -= 1802240.0*xi;
        xi *= x2;
        tn += 2555904.0*xi;
        xi *= x2;
        tn -= 1835008.0*xi;
        xi *= x2;
        tn += 524288.0*xi;
        return tn;

        case 17:
        tn = 17.0;
        xi = x2;
        tn -= 2448.0*xi;
        xi *= x2;
        tn += 57120.0*xi;
        xi *= x2;
        tn -= 502656.0*xi;
        xi *= x2;
        tn += 2154240.0*xi;
        xi *= x2;
        tn -= 4978688.0*xi;
        xi *= x2;
        tn += 6336512.0*xi;
        xi *= x2;
        tn -= 4177920.0*xi;
        xi *= x2;
        tn += 1114112.0*xi;
        return tn;

        case 18:
        xi = x;
        tn = 324.0*xi;
        xi *= x2;
        tn -= 17280.0*xi;
        xi *= x2;
        tn += 266112.0*xi;
        xi *= x2;
        tn -= 1824768.0*xi;
        xi *= x2;
        tn += 6589440.0*xi;
        xi *= x2;
        tn -= 13418496.0*xi;
        xi *= x2;
        tn += 15482880.0*xi;
        xi *= x2;
        tn -= 9437184.0*xi;
        xi *= x2;
        tn += 2359296.0*xi;
        return tn;

        case 19:
        tn = -19.0;
        xi = x2;
        tn += 3420.0*xi;
        xi *= x2;
        tn -= 100320.0*xi;
        xi *= x2;
        tn += 1123584.0*xi;
        xi *= x2;
        tn -= 6259968.0*xi;
        xi *= x2;
        tn += 19475456.0*xi;
        xi *= x2;
        tn -= 35409920.0*xi;
        xi *= x2;
        tn += 37355520.0*xi;
        xi *= x2;
        tn -= 21168128.0*xi;
        xi *= x2;
        tn += 4980736.0*xi;
        return tn;

        case 20:
        xi = x;
        tn = -400.0*xi;
        xi *= x2;
        tn += 26400.0*xi;
        xi *= x2;
        tn -= 506880.0*xi;
        xi *= x2;
        tn += 4392960.0*xi;
        xi *= x2;
        tn -= 20500480.0*xi;
        xi *= x2;
        tn += 55910400.0*xi;
        xi *= x2;
        tn -= 91750400.0*xi;
        xi *= x2;
        tn += 89128960.0*xi;
        xi *= x2;
        tn -= 47185920.0*xi;
        xi *= x2;
        tn += 10485760.0*xi;
        return tn;

        default:
        std::string err_message("Raw Chebyshev polynomial defined for a degree en between 0 and 10.");
        std::cerr << err_message << std::endl;
        throw std::runtime_error(err_message);
    }
}


void chebyshev_poly_roots(int num_points, cusfloat* roots)
{
    for (int k=1; k<=num_points; k++)
    {
        roots[k-1] = -cos((2*k-1)*PI/(2*num_points));
    }
}


void get_gauss_chebyshev(int num_points, cusfloat* weights, cusfloat* roots)
{
    switch (num_points)
    {
        case 1:
            roots[0] = 0.0000000000000001;

            weights[0] = 3.1415926535897931;
            break;

        case 2:
            roots[0] = 0.7071067811865476;
            roots[1] = -0.7071067811865475;

            weights[0] = 1.5707963267948966;
            weights[1] = 1.5707963267948966;
            break;

        case 3:
            roots[0] = 0.8660254037844387;
            roots[1] = 0.0000000000000001;
            roots[2] = -0.8660254037844387;

            weights[0] = 1.0471975511965976;
            weights[1] = 1.0471975511965976;
            weights[2] = 1.0471975511965976;
            break;

        case 4:
            roots[0] = 0.9238795325112867;
            roots[1] = 0.3826834323650898;
            roots[2] = -0.3826834323650897;
            roots[3] = -0.9238795325112867;

            weights[0] = 0.7853981633974483;
            weights[1] = 0.7853981633974483;
            weights[2] = 0.7853981633974483;
            weights[3] = 0.7853981633974483;
            break;

        case 5:
            roots[0] = 0.9510565162951535;
            roots[1] = 0.5877852522924731;
            roots[2] = 0.0000000000000001;
            roots[3] = -0.5877852522924730;
            roots[4] = -0.9510565162951535;

            weights[0] = 0.6283185307179586;
            weights[1] = 0.6283185307179586;
            weights[2] = 0.6283185307179586;
            weights[3] = 0.6283185307179586;
            weights[4] = 0.6283185307179586;
            break;

        case 6:
            roots[0] = 0.9659258262890683;
            roots[1] = 0.7071067811865476;
            roots[2] = 0.2588190451025207;
            roots[3] = -0.2588190451025206;
            roots[4] = -0.7071067811865475;
            roots[5] = -0.9659258262890682;

            weights[0] = 0.5235987755982988;
            weights[1] = 0.5235987755982988;
            weights[2] = 0.5235987755982988;
            weights[3] = 0.5235987755982988;
            weights[4] = 0.5235987755982988;
            weights[5] = 0.5235987755982988;
            break;

        case 7:
            roots[0] = 0.9749279121818236;
            roots[1] = 0.7818314824680298;
            roots[2] = 0.4338837391175582;
            roots[3] = 0.0000000000000001;
            roots[4] = -0.4338837391175581;
            roots[5] = -0.7818314824680295;
            roots[6] = -0.9749279121818237;

            weights[0] = 0.4487989505128276;
            weights[1] = 0.4487989505128276;
            weights[2] = 0.4487989505128276;
            weights[3] = 0.4487989505128276;
            weights[4] = 0.4487989505128276;
            weights[5] = 0.4487989505128276;
            weights[6] = 0.4487989505128276;
            break;

        case 8:
            roots[0] = 0.9807852804032304;
            roots[1] = 0.8314696123025452;
            roots[2] = 0.5555702330196023;
            roots[3] = 0.1950903220161283;
            roots[4] = -0.1950903220161282;
            roots[5] = -0.5555702330196020;
            roots[6] = -0.8314696123025453;
            roots[7] = -0.9807852804032304;

            weights[0] = 0.3926990816987241;
            weights[1] = 0.3926990816987241;
            weights[2] = 0.3926990816987241;
            weights[3] = 0.3926990816987241;
            weights[4] = 0.3926990816987241;
            weights[5] = 0.3926990816987241;
            weights[6] = 0.3926990816987241;
            weights[7] = 0.3926990816987241;
            break;

        case 9:
            roots[0] = 0.9848077530122080;
            roots[1] = 0.8660254037844387;
            roots[2] = 0.6427876096865394;
            roots[3] = 0.3420201433256688;
            roots[4] = 0.0000000000000001;
            roots[5] = -0.3420201433256685;
            roots[6] = -0.6427876096865394;
            roots[7] = -0.8660254037844385;
            roots[8] = -0.9848077530122080;

            weights[0] = 0.3490658503988659;
            weights[1] = 0.3490658503988659;
            weights[2] = 0.3490658503988659;
            weights[3] = 0.3490658503988659;
            weights[4] = 0.3490658503988659;
            weights[5] = 0.3490658503988659;
            weights[6] = 0.3490658503988659;
            weights[7] = 0.3490658503988659;
            weights[8] = 0.3490658503988659;
            break;

        case 10:
            roots[0] = 0.9876883405951378;
            roots[1] = 0.8910065241883679;
            roots[2] = 0.7071067811865476;
            roots[3] = 0.4539904997395469;
            roots[4] = 0.1564344650402309;
            roots[5] = -0.1564344650402306;
            roots[6] = -0.4539904997395467;
            roots[7] = -0.7071067811865475;
            roots[8] = -0.8910065241883678;
            roots[9] = -0.9876883405951377;

            weights[0] = 0.3141592653589793;
            weights[1] = 0.3141592653589793;
            weights[2] = 0.3141592653589793;
            weights[3] = 0.3141592653589793;
            weights[4] = 0.3141592653589793;
            weights[5] = 0.3141592653589793;
            weights[6] = 0.3141592653589793;
            weights[7] = 0.3141592653589793;
            weights[8] = 0.3141592653589793;
            weights[9] = 0.3141592653589793;
            break;

        case 11:
            roots[0] = 0.9898214418809327;
            roots[1] = 0.9096319953545184;
            roots[2] = 0.7557495743542583;
            roots[3] = 0.5406408174555977;
            roots[4] = 0.2817325568414298;
            roots[5] = 0.0000000000000003;
            roots[6] = -0.2817325568414297;
            roots[7] = -0.5406408174555972;
            roots[8] = -0.7557495743542582;
            roots[9] = -0.9096319953545182;
            roots[10] = -0.9898214418809327;

            weights[0] = 0.2855993321445267;
            weights[1] = 0.2855993321445267;
            weights[2] = 0.2855993321445267;
            weights[3] = 0.2855993321445267;
            weights[4] = 0.2855993321445267;
            weights[5] = 0.2855993321445267;
            weights[6] = 0.2855993321445267;
            weights[7] = 0.2855993321445267;
            weights[8] = 0.2855993321445267;
            weights[9] = 0.2855993321445267;
            weights[10] = 0.2855993321445267;
            break;

        case 12:
            roots[0] = 0.9914448613738104;
            roots[1] = 0.9238795325112867;
            roots[2] = 0.7933533402912352;
            roots[3] = 0.6087614290087207;
            roots[4] = 0.3826834323650898;
            roots[5] = 0.1305261922200517;
            roots[6] = -0.1305261922200516;
            roots[7] = -0.3826834323650895;
            roots[8] = -0.6087614290087207;
            roots[9] = -0.7933533402912351;
            roots[10] = -0.9238795325112867;
            roots[11] = -0.9914448613738104;

            weights[0] = 0.2617993877991494;
            weights[1] = 0.2617993877991494;
            weights[2] = 0.2617993877991494;
            weights[3] = 0.2617993877991494;
            weights[4] = 0.2617993877991494;
            weights[5] = 0.2617993877991494;
            weights[6] = 0.2617993877991494;
            weights[7] = 0.2617993877991494;
            weights[8] = 0.2617993877991494;
            weights[9] = 0.2617993877991494;
            weights[10] = 0.2617993877991494;
            weights[11] = 0.2617993877991494;
            break;

        case 13:
            roots[0] = 0.9927088740980540;
            roots[1] = 0.9350162426854148;
            roots[2] = 0.8229838658936564;
            roots[3] = 0.6631226582407953;
            roots[4] = 0.4647231720437686;
            roots[5] = 0.2393156642875580;
            roots[6] = -0.0000000000000002;
            roots[7] = -0.2393156642875575;
            roots[8] = -0.4647231720437685;
            roots[9] = -0.6631226582407950;
            roots[10] = -0.8229838658936564;
            roots[11] = -0.9350162426854147;
            roots[12] = -0.9927088740980540;

            weights[0] = 0.2416609733530610;
            weights[1] = 0.2416609733530610;
            weights[2] = 0.2416609733530610;
            weights[3] = 0.2416609733530610;
            weights[4] = 0.2416609733530610;
            weights[5] = 0.2416609733530610;
            weights[6] = 0.2416609733530610;
            weights[7] = 0.2416609733530610;
            weights[8] = 0.2416609733530610;
            weights[9] = 0.2416609733530610;
            weights[10] = 0.2416609733530610;
            weights[11] = 0.2416609733530610;
            weights[12] = 0.2416609733530610;
            break;

        case 14:
            roots[0] = 0.9937122098932426;
            roots[1] = 0.9438833303083676;
            roots[2] = 0.8467241992282842;
            roots[3] = 0.7071067811865476;
            roots[4] = 0.5320320765153366;
            roots[5] = 0.3302790619551673;
            roots[6] = 0.1119644761033077;
            roots[7] = -0.1119644761033076;
            roots[8] = -0.3302790619551672;
            roots[9] = -0.5320320765153365;
            roots[10] = -0.7071067811865475;
            roots[11] = -0.8467241992282841;
            roots[12] = -0.9438833303083676;
            roots[13] = -0.9937122098932426;

            weights[0] = 0.2243994752564138;
            weights[1] = 0.2243994752564138;
            weights[2] = 0.2243994752564138;
            weights[3] = 0.2243994752564138;
            weights[4] = 0.2243994752564138;
            weights[5] = 0.2243994752564138;
            weights[6] = 0.2243994752564138;
            weights[7] = 0.2243994752564138;
            weights[8] = 0.2243994752564138;
            weights[9] = 0.2243994752564138;
            weights[10] = 0.2243994752564138;
            weights[11] = 0.2243994752564138;
            weights[12] = 0.2243994752564138;
            weights[13] = 0.2243994752564138;
            break;

        case 15:
            roots[0] = 0.9945218953682733;
            roots[1] = 0.9510565162951535;
            roots[2] = 0.8660254037844387;
            roots[3] = 0.7431448254773942;
            roots[4] = 0.5877852522924731;
            roots[5] = 0.4067366430758004;
            roots[6] = 0.2079116908177592;
            roots[7] = 0.0000000000000003;
            roots[8] = -0.2079116908177593;
            roots[9] = -0.4067366430758001;
            roots[10] = -0.5877852522924730;
            roots[11] = -0.7431448254773941;
            roots[12] = -0.8660254037844387;
            roots[13] = -0.9510565162951535;
            roots[14] = -0.9945218953682734;

            weights[0] = 0.2094395102393195;
            weights[1] = 0.2094395102393195;
            weights[2] = 0.2094395102393195;
            weights[3] = 0.2094395102393195;
            weights[4] = 0.2094395102393195;
            weights[5] = 0.2094395102393195;
            weights[6] = 0.2094395102393195;
            weights[7] = 0.2094395102393195;
            weights[8] = 0.2094395102393195;
            weights[9] = 0.2094395102393195;
            weights[10] = 0.2094395102393195;
            weights[11] = 0.2094395102393195;
            weights[12] = 0.2094395102393195;
            weights[13] = 0.2094395102393195;
            weights[14] = 0.2094395102393195;
            break;

        case 16:
            roots[0] = 0.9951847266721969;
            roots[1] = 0.9569403357322088;
            roots[2] = 0.8819212643483550;
            roots[3] = 0.7730104533627370;
            roots[4] = 0.6343932841636455;
            roots[5] = 0.4713967368259978;
            roots[6] = 0.2902846772544623;
            roots[7] = 0.0980171403295608;
            roots[8] = -0.0980171403295606;
            roots[9] = -0.2902846772544622;
            roots[10] = -0.4713967368259977;
            roots[11] = -0.6343932841636454;
            roots[12] = -0.7730104533627370;
            roots[13] = -0.8819212643483549;
            roots[14] = -0.9569403357322088;
            roots[15] = -0.9951847266721968;

            weights[0] = 0.1963495408493621;
            weights[1] = 0.1963495408493621;
            weights[2] = 0.1963495408493621;
            weights[3] = 0.1963495408493621;
            weights[4] = 0.1963495408493621;
            weights[5] = 0.1963495408493621;
            weights[6] = 0.1963495408493621;
            weights[7] = 0.1963495408493621;
            weights[8] = 0.1963495408493621;
            weights[9] = 0.1963495408493621;
            weights[10] = 0.1963495408493621;
            weights[11] = 0.1963495408493621;
            weights[12] = 0.1963495408493621;
            weights[13] = 0.1963495408493621;
            weights[14] = 0.1963495408493621;
            weights[15] = 0.1963495408493621;
            break;

        case 17:
            roots[0] = 0.9957341762950345;
            roots[1] = 0.9618256431728190;
            roots[2] = 0.8951632913550623;
            roots[3] = 0.7980172272802395;
            roots[4] = 0.6736956436465572;
            roots[5] = 0.5264321628773561;
            roots[6] = 0.3612416661871529;
            roots[7] = 0.1837495178165705;
            roots[8] = 0.0000000000000001;
            roots[9] = -0.1837495178165702;
            roots[10] = -0.3612416661871529;
            roots[11] = -0.5264321628773555;
            roots[12] = -0.6736956436465572;
            roots[13] = -0.7980172272802395;
            roots[14] = -0.8951632913550622;
            roots[15] = -0.9618256431728190;
            roots[16] = -0.9957341762950346;

            weights[0] = 0.1847995678582231;
            weights[1] = 0.1847995678582231;
            weights[2] = 0.1847995678582231;
            weights[3] = 0.1847995678582231;
            weights[4] = 0.1847995678582231;
            weights[5] = 0.1847995678582231;
            weights[6] = 0.1847995678582231;
            weights[7] = 0.1847995678582231;
            weights[8] = 0.1847995678582231;
            weights[9] = 0.1847995678582231;
            weights[10] = 0.1847995678582231;
            weights[11] = 0.1847995678582231;
            weights[12] = 0.1847995678582231;
            weights[13] = 0.1847995678582231;
            weights[14] = 0.1847995678582231;
            weights[15] = 0.1847995678582231;
            weights[16] = 0.1847995678582231;
            break;

        case 18:
            roots[0] = 0.9961946980917455;
            roots[1] = 0.9659258262890683;
            roots[2] = 0.9063077870366499;
            roots[3] = 0.8191520442889918;
            roots[4] = 0.7071067811865476;
            roots[5] = 0.5735764363510462;
            roots[6] = 0.4226182617406994;
            roots[7] = 0.2588190451025210;
            roots[8] = 0.0871557427476581;
            roots[9] = -0.0871557427476580;
            roots[10] = -0.2588190451025209;
            roots[11] = -0.4226182617406993;
            roots[12] = -0.5735764363510462;
            roots[13] = -0.7071067811865475;
            roots[14] = -0.8191520442889919;
            roots[15] = -0.9063077870366499;
            roots[16] = -0.9659258262890683;
            roots[17] = -0.9961946980917455;

            weights[0] = 0.1745329251994329;
            weights[1] = 0.1745329251994329;
            weights[2] = 0.1745329251994329;
            weights[3] = 0.1745329251994329;
            weights[4] = 0.1745329251994329;
            weights[5] = 0.1745329251994329;
            weights[6] = 0.1745329251994329;
            weights[7] = 0.1745329251994329;
            weights[8] = 0.1745329251994329;
            weights[9] = 0.1745329251994329;
            weights[10] = 0.1745329251994329;
            weights[11] = 0.1745329251994329;
            weights[12] = 0.1745329251994329;
            weights[13] = 0.1745329251994329;
            weights[14] = 0.1745329251994329;
            weights[15] = 0.1745329251994329;
            weights[16] = 0.1745329251994329;
            weights[17] = 0.1745329251994329;
            break;

        case 19:
            roots[0] = 0.9965844930066698;
            roots[1] = 0.9694002659393304;
            roots[2] = 0.9157733266550574;
            roots[3] = 0.8371664782625285;
            roots[4] = 0.7357239106731316;
            roots[5] = 0.6142127126896679;
            roots[6] = 0.4759473930370735;
            roots[7] = 0.3246994692046836;
            roots[8] = 0.1645945902807338;
            roots[9] = 0.0000000000000001;
            roots[10] = -0.1645945902807338;
            roots[11] = -0.3246994692046832;
            roots[12] = -0.4759473930370735;
            roots[13] = -0.6142127126896678;
            roots[14] = -0.7357239106731316;
            roots[15] = -0.8371664782625283;
            roots[16] = -0.9157733266550575;
            roots[17] = -0.9694002659393304;
            roots[18] = -0.9965844930066698;

            weights[0] = 0.1653469817678838;
            weights[1] = 0.1653469817678838;
            weights[2] = 0.1653469817678838;
            weights[3] = 0.1653469817678838;
            weights[4] = 0.1653469817678838;
            weights[5] = 0.1653469817678838;
            weights[6] = 0.1653469817678838;
            weights[7] = 0.1653469817678838;
            weights[8] = 0.1653469817678838;
            weights[9] = 0.1653469817678838;
            weights[10] = 0.1653469817678838;
            weights[11] = 0.1653469817678838;
            weights[12] = 0.1653469817678838;
            weights[13] = 0.1653469817678838;
            weights[14] = 0.1653469817678838;
            weights[15] = 0.1653469817678838;
            weights[16] = 0.1653469817678838;
            weights[17] = 0.1653469817678838;
            weights[18] = 0.1653469817678838;
            break;

        case 20:
            roots[0] = 0.9969173337331280;
            roots[1] = 0.9723699203976766;
            roots[2] = 0.9238795325112867;
            roots[3] = 0.8526401643540923;
            roots[4] = 0.7604059656000309;
            roots[5] = 0.6494480483301838;
            roots[6] = 0.5224985647159489;
            roots[7] = 0.3826834323650898;
            roots[8] = 0.2334453638559055;
            roots[9] = 0.0784590957278450;
            roots[10] = -0.0784590957278449;
            roots[11] = -0.2334453638559053;
            roots[12] = -0.3826834323650897;
            roots[13] = -0.5224985647159488;
            roots[14] = -0.6494480483301835;
            roots[15] = -0.7604059656000309;
            roots[16] = -0.8526401643540922;
            roots[17] = -0.9238795325112867;
            roots[18] = -0.9723699203976766;
            roots[19] = -0.9969173337331280;

            weights[0] = 0.1570796326794897;
            weights[1] = 0.1570796326794897;
            weights[2] = 0.1570796326794897;
            weights[3] = 0.1570796326794897;
            weights[4] = 0.1570796326794897;
            weights[5] = 0.1570796326794897;
            weights[6] = 0.1570796326794897;
            weights[7] = 0.1570796326794897;
            weights[8] = 0.1570796326794897;
            weights[9] = 0.1570796326794897;
            weights[10] = 0.1570796326794897;
            weights[11] = 0.1570796326794897;
            weights[12] = 0.1570796326794897;
            weights[13] = 0.1570796326794897;
            weights[14] = 0.1570796326794897;
            weights[15] = 0.1570796326794897;
            weights[16] = 0.1570796326794897;
            weights[17] = 0.1570796326794897;
            weights[18] = 0.1570796326794897;
            weights[19] = 0.1570796326794897;
            break;

    }
}